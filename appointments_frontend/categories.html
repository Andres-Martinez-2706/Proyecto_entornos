<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Categorías - Citas App</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="app-page">
    <!-- Header -->
    <header class="app-header">
        <div class="header-left">
            <button id="sidebarToggle" class="sidebar-toggle" aria-label="Menú">
                <span class="hamburger"></span>
            </button>
            <div class="logo">
                <h1>📅 Citas App</h1>
            </div>
        </div>
        <div class="header-right">
            <span id="userName" class="user-name"></span>
            <button id="logoutBtn" class="btn btn-outline-sm">Cerrar Sesión</button>
        </div>
    </header>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
        <nav class="sidebar-nav">
            <a href="home.html" class="nav-item">
                <span class="nav-icon">🏠</span>
                <span class="nav-text">Inicio</span>
            </a>
            <a href="appointments.html" class="nav-item">
                <span class="nav-icon">📅</span>
                <span class="nav-text">Citas</span>
            </a>
            <a href="notifications.html" class="nav-item">
                <span class="nav-icon">🔔</span>
                <span class="nav-text">Notificaciones</span>
                <span id="notificationBadge" class="badge"></span>
            </a>
            <a href="categories.html" class="nav-item active">
                <span class="nav-icon">📁</span>
                <span class="nav-text">Categorías</span>
            </a>
            <a href="profile.html" class="nav-item">
                <span class="nav-icon">👤</span>
                <span class="nav-text">Perfil</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Page Header -->
            <div class="page-header">
                <h2 class="page-title">Gestión de Categorías</h2>
                <button id="createCategoryBtn" class="btn btn-primary">
                    <span>➕</span> Nueva Categoría
                </button>
            </div>

            <!-- Info Card -->
            <div class="info-card">
                <p style="margin: 0;">
                    Las categorías permiten organizar las citas por tipo. 
                    Puedes crear, editar y eliminar categorías según las necesidades del sistema.
                    <strong>Nota:</strong> No se pueden eliminar categorías que están siendo usadas por citas activas.
                </p>
            </div>

            <!-- Loading State -->
            <div id="categoriesLoading" class="loading-state">
                <div class="spinner"></div>
                <p>Cargando categorías...</p>
            </div>

            <!-- Empty State -->
            <div id="categoriesEmpty" class="empty-state" style="display: none;">
                <div class="empty-icon">📂</div>
                <h4>No hay categorías</h4>
                <p>Aún no hay categorías registradas en el sistema</p>
                <button class="btn btn-primary" onclick="document.getElementById('createCategoryBtn').click()">
                    Crear primera categoría
                </button>
            </div>

            <!-- Categories Grid -->
            <div id="categoriesGrid" class="categories-grid" style="display: none;"></div>
        </div>
    </main>

    <!-- Modal Create/Edit Category -->
    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" data-modal="categoryModal">&times;</span>
            <h2 id="categoryModalTitle" class="modal-title">Nueva Categoría</h2>
            <form id="categoryForm" class="form">
                <input type="hidden" id="categoryId">
                
                <div class="form-group">
                    <label for="categoryName">Nombre *</label>
                    <input type="text" id="categoryName" name="name" required 
                           placeholder="Ej: Médica, Académica, Trabajo" maxlength="100">
                </div>

                <div class="form-group">
                    <label for="categoryDescription">Descripción</label>
                    <textarea id="categoryDescription" name="description" rows="3" 
                              placeholder="Breve descripción de la categoría"></textarea>
                </div>

                <div id="categoryError" class="error-message"></div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" data-modal="categoryModal">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Delete Confirmation -->
    <div id="deleteCategoryModal" class="modal">
        <div class="modal-content modal-small">
            <span class="modal-close" data-modal="deleteCategoryModal">&times;</span>
            <h2 class="modal-title">Confirmar Eliminación</h2>
            <input type="hidden" id="deleteCategoryId">
            <p id="deleteCategoryMessage" class="modal-text">¿Estás seguro de eliminar esta categoría?</p>
            <p class="modal-text" style="color: var(--danger); font-weight: 600;">
                ⚠️ Esta acción no se puede deshacer.
            </p>
            <div id="deleteCategoryError" class="error-message"></div>
            <div class="form-actions">
                <button type="button" class="btn btn-outline" data-modal="deleteCategoryModal">Cancelar</button>
                <button id="confirmDeleteCategoryBtn" class="btn btn-danger">Eliminar</button>
            </div>
        </div>
    </div>

    <!-- Modal View Details -->
    <div id="categoryDetailsModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" data-modal="categoryDetailsModal">&times;</span>
            <h2 class="modal-title">Detalles de la Categoría</h2>
            <div id="categoryDetailsContent" class="details-content"></div>
            <div class="form-actions">
                <button type="button" class="btn btn-primary" data-modal="categoryDetailsModal">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Overlay -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/categories.js"></script>
</body>
</html>